## 変数

```powershell
$a = 1
$b = $c = $a

New-Variable -name a
```

### 型を指定

```powershell
$a = 1 # 型を指定しなければObject型

# 明示的に型を指定
[byte]$val = 1
[double]$val = 0
[int]$val = 3
[string]$val = "4"
```

### スコープ

| スコープ | 内容                 |
| :------- | :------------------- |
| private  | ブロック内           |
| local    | ブロックと子ブロック |
| script   | ファイル内           |
| global   | ファイル外           |

### 自動変数

```powershell
Get-Variable
```

```powershell
Get-Variable | Get-Member -MemberType Properties
```

| $Host                   |  |
| $InformationPreference  |                                          |
| $input                  |                 |

| 変数名                      | 内容                                                 |
| --------------------------- | ---------------------------------------------------- |
| $env:ENVVAR                 | 環境変数                                             |
|                             |                                                      |
| _ ( PSItem と同じ)          | パイプラインオブジェクトの現在のオブジェクト         |
| ?                           | 最後のコマンドの実行状態(リターンコード)             |
| ^                           | セッションによって受信された最後の行の最初のトークン |
| $                           | セッションによって受信された最後の行の最後のトークン |
| args                        | コマンドライン引数                                   |
| cert                        |                                                      |
| ConfirmPreference           |                                                      |
| DebugPreference             |                                                      |
| EnabledExperimentalFeatures |                                                      |
| Error                       | 最後のエラー                                         |
| ErrorActionPreference       |                                                      |
| ErrorView                   |                                                      |
| ExecutionContext            |                                                      |
| false                       | False                                                |
| FormatEnumerationLimit      |                                                      |
| HOME                        | ホームディレクトリのパス                             |
| Host                        | ホストアプリケーションを表すオブジェクト             |
| InformationPreference       |                                                      |
| input                       | 関数に渡される入力                                   |
| IsCoreCLR                   |                                                      |
| IsLinux                     |                                                      |
| IsMacOS                     |                                                      |
| IsWindows                   |                                                      |
| MaximumHistoryCount         |                                                      |
| MyInvocation                | 現在のコマンドに関する情報                           |
| NestedPromptLevel           |                                                      |
| null                        | NULL                                                 |
| OutputEncoding              |                                                      |
| PID                         | ホストしているプロセスのプロセス識別子 (PID)         |
| profile                     | PowerShell プロファイルのパス                        |
| ProgressPreference          |                                                      |
| PSBoundParameters           |                                                      |
| PSCommandPath               |                                                      |
| PSCulture                   |                                                      |
| PSDefaultParameterValues    |                                                      |
| PSEdition                   |                                                      |
| psEditor                    |                                                      |
| PSEmailServer               |                                                      |
| PSHOME                      | PowerShell のインストールディレクトリのパス          |
| PSScriptRoot                | スクリプトの実行元のディレクトリ                     |
| PSSessionApplicationName    |                                                      |
| PSSessionConfigurationName  |                                                      |
| PSSessionOption             |                                                      |
| PSStyle                     |                                                      |
| PSUICulture                 |                                                      |
| PSVersionTable              | PowerShell のバージョン                              |
| PWD                         | カレントディレクトリ                                 |
| ShellId                     |                                                      |
| StackTrace                  |                                                      |
| targetScriptPath            |                                                      |
| true                        | True                                                 |
| VerbosePreference           |                                                      |
| WarningPreference           |                                                      |
| WhatIfPreference            |                                                      |

### 配列

```powershell
# 配列の宣言
$array1 = @()
[int[]]$array2

# 配列への代入
$array3 = @(1)
$array3 = ,1

$array4 = @(2,3,4)
$array4 = @(..4)
$array4 = 2,3,4
$array4 = ..4

# 配列の結合
$array = $array1 + $array2

# 要素の追加と変更
$array5 = @()
$array5[0] = 555 # これはSystem.IndexOutOfRangeExceptionとなる
$array5 += 555 # 末尾に追加
$array5 += 5555
$array5[0] = 55

# 要素の削除
$array6 = @(6,66,666)
$array6
$array6[1] = $null
$array6
```

> 6
> 66
> 666

> 6
> 666

```powershell
$array = .1000

# 指定された値が配列に含まれるか検査する
$array -contains 5

# 配列の要素を参照
$array[0]

$array[-1]

$array[10..200] # 添え字も配列
```

> True

> 2

> 4

> 102
> 103
> (中略)
> 201

#### 多次元配列

```powershell
$array = @(("1-1","1-2","1-3","1-4"),("2-1","2-2","2-3","2-4"))
$array[1][2]
```

> 2-3

#### 連想配列(ハッシュテーブル)

```powershell
# 連想配列の宣言と代入
$table = @{key1 = "value1"; key2 = "value2"; key3 = "value3"}
$table["key1"]
```

> value1

```powershell
# 要素の追加
$table.Add("key4", "value4")
# OR
$table.key4 = "value4"

# 要素の変更
$table["key3"] = "value33"
# OR
$table.key3 = "value33"

# 要素を削除
$table.Remove("key2")
```

> Name                           Value
> ----                           -----
> key3                           value33
> key1                           value1
> key4                           value4

```powershell
# 指定されたキーに対応する値が存在するか検査する
$table.ContainsKey("key1")

# 指定された値に対応するキーが存在するか検査する
$table.ContainsValue("value33")

# 指定されたキーが配列に含まれるか検査する
$table.Contains("key1")
$table.Contains("value0")
```

> True
> False

```powershell
# すべてのキーを取得する
$keys = $table.Keys

# すべての値を取得する
$values = $table.Values

# 要素ごとに処理する
foreach ($key in $table.Keys) {
    $key + ": " + $table[$key]
}
```

> key3: value3
> key1: value1
> key2: value2
